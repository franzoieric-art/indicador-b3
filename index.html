<!DOCTYPE html>
<html lang="pt-br">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Indicador B3 - Rico Plus</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
  <style>
    /* === ESTILOS GERAIS === */
    :root { 
      --main-color: #5a23c8; 
      --bg-color: #050505; 
      --card-bg: #111111;
      --input-bg: #1a1a1a;
      --text-color: #ffffff; 
      --border-color: #333;
    }
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Inter', sans-serif; }
    body, html { height: 100%; width: 100%; background: var(--bg-color); color: var(--text-color); overflow: hidden; }

    /* ======================================================= */
    /* ESTILOS DO APP (CALCULADORA)                           */
    /* ======================================================= */
    #app-content {
      position: absolute; top: 0; left: 0; width: 100%; height: 100%;
      display: flex; align-items: center; justify-content: center;
      z-index: 1; 
      background-image: radial-gradient(circle at top right, #1a0b36 0%, transparent 40%);
      overflow-y: auto;
    }

    .calculator-container {
      background: var(--card-bg);
      width: 100%; max-width: 480px;
      padding: 30px; margin: 20px;
      border-radius: 16px;
      border: 1px solid var(--border-color);
      box-shadow: 0 20px 50px rgba(0,0,0,0.5);
      position: relative;
    }

    .input-group { margin-bottom: 20px; }
    .label-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
    .label-row label { font-size: 14px; color: #aaa; font-weight: 500; }
    .link-helper { color: #5a8dee; font-size: 12px; text-decoration: none; cursor: pointer; transition: 0.2s; }
    .link-helper:hover { text-decoration: underline; color: #fff; }

    .custom-input {
      width: 100%; background: var(--input-bg);
      border: 1px solid var(--border-color);
      padding: 12px 15px; border-radius: 8px;
      color: white; font-size: 16px; outline: none; transition: 0.3s;
    }
    .custom-input:focus { border-color: var(--main-color); background: #222; }

    .row-split { display: flex; gap: 15px; }
    .col-half { flex: 1; }

    .btn-analyze {
      width: 100%; background: linear-gradient(90deg, #5a23c8 0%, #7b2cbf 100%);
      border: none; padding: 16px; border-radius: 8px;
      color: white; font-size: 16px; font-weight: 700;
      cursor: pointer; margin-top: 10px;
      box-shadow: 0 4px 15px rgba(90, 35, 200, 0.4);
      display: flex; align-items: center; justify-content: center; gap: 10px;
      transition: transform 0.2s;
    }
    .btn-analyze:hover { transform: translateY(-2px); filter: brightness(1.1); }

    .footer-note { text-align: center; margin-top: 20px; font-size: 12px; color: #444; }

    /* Resultado Box */
    #result-box {
      display: none; margin-top: 20px; padding: 20px;
      background: rgba(255,255,255,0.05); border-radius: 8px;
      border: 1px solid #333; text-align: center; animation: fadeIn 0.5s;
    }
    #result-title { font-size: 18px; font-weight: bold; margin-bottom: 5px; }
    #result-desc { font-size: 14px; color: #bbb; }

    /* ======================================================= */
    /* ESTILOS DO OVERLAY (FORMUL√ÅRIO)                        */
    /* ======================================================= */
    .onboarding-overlay {
      position: fixed; top: 0; left: 0; width: 100%; height: 100%;
      background: var(--bg-color); z-index: 9999; 
      display: flex; flex-direction: column; justify-content: center; padding: 30px;
      transition: opacity 0.8s ease;
    }
    .progress-bar-container { position: fixed; top: 0; left: 0; width: 100%; height: 4px; background: #222; z-index: 10000; }
    .progress-bar-fill { height: 100%; background: var(--main-color); width: 33%; transition: width 0.6s cubic-bezier(0.25, 0.8, 0.25, 1); }
    .onboarding-inner { max-width: 640px; margin: 0 auto; width: 100%; }
    .step { display: none; opacity: 0; transform: translateY(30px); transition: all 0.5s ease-out; }
    .step.active { display: block; opacity: 1; transform: translateY(0); }
    .question-number { color: var(--main-color); font-size: 13px; font-weight: 700; margin-bottom: 15px; display: block; letter-spacing: 1px; }
    .question-number span { border: 1px solid var(--main-color); padding: 2px 6px; border-radius: 4px; margin-right: 10px; }
    h2 { font-size: 32px; font-weight: 400; margin-bottom: 40px; color: #eee; line-height: 1.3; }
    h2 strong { font-weight: 700; color: #fff; }
    .options-grid { display: flex; flex-direction: column; gap: 12px; width: 100%; }
    .option-card { background: rgba(255,255,255,0.05); border: 1px solid #333; padding: 18px 25px; border-radius: 8px; color: #fff; font-size: 18px; cursor: pointer; text-align: left; display: flex; align-items: center; transition: 0.3s; }
    .option-card:hover { background: rgba(90, 35, 200, 0.1); border-color: var(--main-color); transform: translateX(5px); }
    .key-hint { background: #222; font-size: 12px; padding: 4px 8px; border-radius: 4px; margin-right: 15px; color: #888; font-weight: 700; }
    .big-input { width: 100%; background: transparent; border: none; border-bottom: 2px solid #444; color: var(--main-color); font-size: 32px; padding: 10px 0; outline: none; }
    .big-input::placeholder { color: #444; font-size: 32px; }
    .btn-finish { margin-top: 40px; background-color: var(--main-color); color: white; font-size: 20px; font-weight: 700; border: none; padding: 18px 40px; width: 100%; border-radius: 8px; cursor: pointer; display: flex; align-items: center; justify-content: center; box-shadow: 0 4px 15px rgba(90, 35, 200, 0.3); transition: 0.3s; }
    .btn-finish:hover { transform: translateY(-2px); filter: brightness(1.1); }
    .final-screen-overlay { display: none; text-align: center; animation: fadeIn 0.5s; }
    .success-icon { font-size: 60px; margin-bottom: 20px; display: block; }
    .btn-access-app { background: var(--main-color); color: white; border: none; padding: 16px 32px; font-size: 18px; border-radius: 8px; cursor: pointer; font-weight: bold; margin-top: 30px; width: 100%; box-shadow: 0 4px 15px rgba(90, 35, 200, 0.3); transition: 0.3s; }
    .btn-access-app:hover { background: #4a1da8; transform: translateY(-2px); }
    .loading-screen { display: none; text-align: center; margin-top: 80px; }
    .spinner { border: 3px solid rgba(255,255,255,0.1); border-top: 3px solid var(--main-color); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin: 0 auto 20px auto; }
    @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
  </style>
</head>
<body>

  <div id="app-content">
    <div class="calculator-container">
      
      <div class="input-group">
        <div class="label-row">
          <label>Petr√≥leo Brent (UKOIL)</label>
          <a href="https://br.tradingview.com/symbols/TVC-UKOIL/" target="_blank" class="link-helper">‚Üó Ver Cota√ß√£o</a>
        </div>
        <input type="number" id="inpBrent" class="custom-input" placeholder="Ex: -0.20" step="0.01">
      </div>

      <div class="input-group">
        <div class="label-row">
          <label>S&P 500 Futuro (ES1!)</label>
          <a href="https://br.tradingview.com/symbols/CME_MINI-ES1!/" target="_blank" class="link-helper">‚Üó Ver Cota√ß√£o</a>
        </div>
        <input type="number" id="inpSp" class="custom-input" placeholder="Ex: 0.34" step="0.01">
      </div>

      <div class="input-group">
        <div class="label-row">
          <label>VIX (√çndice do Medo)</label>
          <a href="https://br.tradingview.com/symbols/TVC-VIX/" target="_blank" class="link-helper">‚Üó Ver Cota√ß√£o</a>
        </div>
        <input type="number" id="inpVix" class="custom-input" placeholder="Ex: 4.83" step="0.01">
      </div>

      <div class="row-split">
        <div class="col-half">
          <div class="input-group">
            <div class="label-row">
              <label>DXY (%)</label>
              <a href="https://br.tradingview.com/symbols/TVC-DXY/" target="_blank" class="link-helper">‚Üó Ver</a>
            </div>
            <input type="number" id="inpDxy" class="custom-input" placeholder="Ex: 0.02">
          </div>
        </div>
        <div class="col-half">
          <div class="input-group">
            <div class="label-row">
              <label>USD/BRL (Pre√ßo)</label>
              <a href="https://br.tradingview.com/symbols/FX_IDC-USDBRL/" target="_blank" class="link-helper">‚Üó Ver</a>
            </div>
            <input type="number" id="inpDol" class="custom-input" placeholder="Ex: 5.75">
          </div>
        </div>
      </div>

      <button class="btn-analyze" onclick="calcularFluxo()">
        ‚ö° Analisar Mercado Agora
      </button>

      <div id="result-box">
        <div id="result-title">Aguardando...</div>
        <div id="result-desc">Insira os dados acima para calcular.</div>
      </div>

      <div class="footer-note">Desenvolvido por Traders Profissionais - Rico Plus</div>
    </div>
  </div>

  <div class="onboarding-overlay" id="overlay">
    <div class="progress-bar-container"><div class="progress-bar-fill" id="progressBar"></div></div>
    
    <div class="onboarding-inner">
      
      <div class="step active" id="step1">
        <span class="question-number"><span>1</span> SETUP</span>
        <h2>Qual plataforma voc√™ usa?</h2>
        <div class="options-grid">
          <button class="option-card" onclick="next(1, 'Plataforma', 'ProfitPro')"><span class="key-hint">A</span> ProfitPro</button>
          <button class="option-card" onclick="next(1, 'Plataforma', 'Tryd')"><span class="key-hint">B</span> Tryd</button>
          <button class="option-card" onclick="next(1, 'Plataforma', 'Outra')"><span class="key-hint">C</span> Outra / Nenhuma</button>
        </div>
      </div>

      <div class="step" id="step2">
        <span class="question-number"><span>2</span> N√çVEL</span>
        <h2>Tempo de mercado?</h2>
        <div class="options-grid">
          <button class="option-card" onclick="next(2, 'Tempo', 'Iniciante')"><span class="key-hint">A</span> Iniciante</button>
          <button class="option-card" onclick="next(2, 'Tempo', 'Intermedi√°rio')"><span class="key-hint">B</span> Intermedi√°rio</button>
          <button class="option-card" onclick="next(2, 'Tempo', 'Experiente')"><span class="key-hint">C</span> Experiente</button>
        </div>
      </div>

      <div class="step" id="step3">
        <span class="question-number"><span>3</span> ACESSO</span>
        <h2>Email para libera√ß√£o</h2>
        <input type="email" id="emailInput" class="big-input" placeholder="seu@email.com" required>
        <button class="btn-finish" onclick="finish()">FINALIZAR E ACESSAR üöÄ</button>
      </div>

      <div class="loading-screen" id="loadingScreen">
        <div class="spinner"></div>
        <p style="color:#888;">Validando seus dados...</p>
      </div>

      <div class="final-screen-overlay" id="finalOverlayScreen">
        <span class="success-icon">‚úÖ</span>
        <h2>Tudo pronto!</h2>
        <p style="color:#aaa; margin-bottom: 30px; font-size: 16px;">Seu perfil foi configurado. Voc√™ j√° pode acessar a ferramenta oficial do Indicador B3.</p>
        
        <div style="background: #111; padding: 20px; border-radius: 12px; border: 1px solid #333;">
            <h3 style="color: var(--main-color); margin-bottom: 10px;">Indicador B3 v2.0</h3>
            <p style="font-size: 14px; color: #666; margin-bottom: 20px;">Ferramenta exclusiva Rico Plus para leitura de fluxo.</p>
            <button class="btn-access-app" onclick="revelarApp()">ACESSAR AGORA üöÄ</button>
        </div>
        
        <div style="margin-top: 30px; padding: 10px; background: rgba(46, 204, 113, 0.1); border: 1px solid #2ecc71; border-radius: 20px; display: inline-block; color: #2ecc71; font-size: 13px;">
            üì© Enviamos tamb√©m um link de backup para seu e-mail.
        </div>
      </div>

    </div>
  </div>

  <script>
    // === URL ATUALIZADA QUE VOC√ä FORNECEU ===
    const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwhuBRXb3cSiiOsCtMaQmqQOSiKX_S7Um7JhvfX1b3JNOOTUjos3s737h_Ju672w3lz/exec';

    // === 1. DETECTOR DE PASSE VIP (A M√°gica acontece aqui) ===
    // Assim que a p√°gina carrega, verificamos se veio do e-mail
    window.onload = function() {
      const params = new URLSearchParams(window.location.search);
      // Se tiver "?acesso=vip" no link, destru√≠mos o formul√°rio
      if (params.get('acesso') === 'vip') {
        document.getElementById('overlay').style.display = 'none';
        document.body.style.overflow = 'auto'; // Destrava a rolagem
      }
    };

    // === 2. L√ìGICA DA CALCULADORA ===
    function calcularFluxo() {
        const elBrent = document.getElementById('inpBrent');
        const elSp = document.getElementById('inpSp');
        const elVix = document.getElementById('inpVix');
        const elDxy = document.getElementById('inpDxy');

        if(elBrent.value === "" || elSp.value === "" || elVix.value === "" || elDxy.value === "") {
            alert("‚ö†Ô∏è Aten√ß√£o: Preencha todos os campos para ter uma an√°lise precisa.");
            return;
        }

        let brent = parseFloat(elBrent.value);
        let sp = parseFloat(elSp.value);
        let vix = parseFloat(elVix.value);
        let dxy = parseFloat(elDxy.value);

        let score = 0;
        
        if (sp > 0) score += 2; else score -= 2;
        if (brent > 0) score += 1; else score -= 1;
        if (vix < 0) score += 1; else score -= 2;
        if (dxy < 0) score += 1; else score -= 1;

        const box = document.getElementById('result-box');
        const title = document.getElementById('result-title');
        const desc = document.getElementById('result-desc');

        box.style.display = 'block';

        if (score >= 1) {
            box.style.borderColor = '#00b894';
            box.style.backgroundColor = 'rgba(0, 184, 148, 0.1)';
            title.style.color = '#00b894';
            title.innerHTML = "VI√âS COMPRADOR (BULLISH) üêÇ";
            desc.innerHTML = "Cen√°rio externo positivo. S&P e Commodities ajudando.";
        } else if (score <= -2) {
            box.style.borderColor = '#d63031';
            box.style.backgroundColor = 'rgba(214, 48, 49, 0.1)';
            title.style.color = '#d63031';
            title.innerHTML = "VI√âS VENDEDOR (BEARISH) üêª";
            desc.innerHTML = "Avers√£o a risco no exterior. Cuidado com compras.";
        } else {
            box.style.borderColor = '#f1c40f';
            box.style.backgroundColor = 'rgba(241, 196, 15, 0.1)';
            title.style.color = '#f1c40f';
            title.innerHTML = "MERCADO NEUTRO / LATERAL ‚öñÔ∏è";
            desc.innerHTML = "Sinais mistos. Aguarde confirma√ß√£o no gr√°fico.";
        }
    }

    // === 3. L√ìGICA DO FORMUL√ÅRIO (OVERLAY) ===
    let answers = {};

    function next(step, field, val) {
      answers[field] = val;
      const current = document.getElementById('step'+step);
      current.style.opacity = '0';
      current.style.transform = 'translateY(-20px)';
      setTimeout(() => {
        current.style.display = 'none';
        const nextStep = document.getElementById('step'+(step+1));
        if(nextStep) {
          nextStep.classList.add('active');
          document.getElementById('progressBar').style.width = ((step+1)/3)*100+'%';
        }
      }, 400);
    }

    function finish() {
      const email = document.getElementById('emailInput').value.trim();
      if(!email.includes('@') || email.length < 5) return alert('Por favor, digite um email v√°lido.');
      
      answers['Email'] = email;
      document.getElementById('step3').style.display = 'none';
      document.getElementById('loadingScreen').style.display = 'block';

      fetch(SCRIPT_URL, {
        method: 'POST', mode: 'no-cors',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify(answers)
      }).then(() => {
        mostrarBotaoFinal();
      }).catch(e => {
        console.error(e);
        mostrarBotaoFinal(); 
      });
    }

    function mostrarBotaoFinal() {
      document.getElementById('loadingScreen').style.display = 'none';
      document.getElementById('finalOverlayScreen').style.display = 'block';
    }

    function revelarApp() {
      const overlay = document.getElementById('overlay');
      overlay.style.opacity = '0';
      setTimeout(() => {
        overlay.style.display = 'none';
        document.body.style.overflow = 'auto';
      }, 800);
    }

    document.getElementById('emailInput').addEventListener('keypress', function (e) {
      if (e.key === 'Enter') finish();
    });
  </script>
</body>
</html>
